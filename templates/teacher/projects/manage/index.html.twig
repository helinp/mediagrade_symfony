{% extends 'base.html.twig' %}

{% block sidebar %}
	{{ include("teacher/_sidebar.html.twig") }}
{% endblock %}
{% block topbar %}
	{{ include("teacher/_topbar.html.twig") }}

	{% block topbar_widget %}
		<div class="container-fluid row">
			<div class="col-6 col-sm-4 col-md-3 col-xl-2">
				<div class="form-group">
					{{form_widget(courses_form)}}
				</div>
			</div>
			<div class="col-6 col-sm-4 col-md-3 col-xl-2">
				<div class="form-group">
					{{form_widget(school_year_form)}}
				</div>
			</div>

		</div>
	{% endblock %}
{% endblock %}

{% block title %}Gestion des projets
{% endblock %}

{% block body %}


	<!-- A corriger-->
	<div class="col mb-2">
		<a href="/teacher/projects/new" class="mb-2 d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm">
			<i class="fas fa-file fa-sm text-white-50"></i>
			Nouveau projet
		</a>
		{% for course in courses %}
		{% if course.currentProjects | length > 0 %}
			<div class="row mt-4 text-primary mb-2" style='border-bottom: 1px dashed lightgray'>
				<div class="col">
					<h3>{{ course.name }}</h3>
				</div>
			</div>
			<div class="row">
				{% for project in course.currentProjects %}
					<div class="col-4 p-2">
						<div class="card shadow">
							<div class="card-body">
								<div class="card-text">
									<div class="row mb-2 pb-1" style='border-bottom: 1px dashed lightgray'>
										<div class="col mb-2">
											<h5 class="m-0 font-weight-bold text-primary">{{project.name}}</h5>
											<h6 class="m-0 font-weight-bold text-primary">
												{{project.course.name}}
												/
												{{project.term.name}}
											</h6>
										</div>
									</div>
								</div>
								<div class="card-text" style="min-height: 4em;">
									<q>{{project.context}}</q>
								</div>
							</div>
							<div class="card-footer">
								<span class="badge badge-success mr-2" data-toggle="tooltip" data-placement="top" title="Ã‰valuation {{project.assessmentType.description}}">{{project.assessmentType.name}}</span>

								<span class="mr-2">
									<i class="fas fa-play-circle"></i>
									{{project.startDate|date("d/m")}}
								</span>

								<span class="mr-2">
									<i class="fas fa-pause-circle"></i>
									{{project.softDeadline|date("d/m")}}
								</span>

								<span class="mr-2">
									<i class="fas fa-stop-circle"></i>
									{{project.hardDeadline|date("d/m")}}
								</span>

								<a href="/teacher/projects/edit/{{project.id}}" class="btn btn-sm btn-secondary float-right">
									<i class="fas fa-edit"></i>
									Modifier</a>

							</div>
						</div>
					</div>

				{% endfor %}
			</div>
		{% endif %}
		{% endfor %}
	</div>

{% endblock %}
{% block page_scripts %}
	<script>


		{% set currentPath = path(app.request.attributes.get('_route'),
                       app.request.attributes.get('_route_params')) %}

$('#school_years_schoolYear').change(function () { // set the window's location property to the value of the option the user has selected
window.location = '{{ currentPath }}?school_year=' + $(this).val();
});

	</script>
{% endblock %}
