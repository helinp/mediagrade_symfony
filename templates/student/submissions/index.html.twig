{% extends 'base.html.twig' %}

{% block sidebar %}
	{{ include("student/_sidebar.html.twig") }}
{% endblock %}
{% block topbar %}
	{{ include("student/_topbar.html.twig") }}
{% endblock %}

{% block title %}Remises des projets
{% endblock %}

{% block body %}


	{% if projects | length == 0 %}

		<div class="col-12">
			<div class="card shadow border-left-primary h-100 py-2">
				<div class="card-body">

					Aucun projet n'a encore été mis en ligne par le professeur.

				</div>
			</div>
		</div>

	{% endif %}

	{% for project in projects %}

	{% if project.external == false %}
		<div class="results-overview-row col-12 card shadow border-left-primary h-100 py-2 mb-4">
			<div class="card-body row">
				<div class="col-12">
					<h5 class="font-weight-bold text-primary text-uppercase">
						{{project.course.name}}
						/
						{{project.name}}
						<br/><small>{{project.term.description}}
							/
							{{project.assessmentType.description}}</small>
					</h5>
					<p class="text-context">{{project.context}}</p>
				</div>

				{% set submitted = false %}
				{% for submission in submissions %}

					{% for submissionFile in submission.submissionFiles  %}
						{% if submission.project.id == project.id %}
							{% set submitted = true %}
						{% endif %}
					{% endfor %}

				{% endfor %}

				{% if project.hardDeadline|date("ymd") >= "now"|date("ymd") %}
					<div class="col-12">
						<div class="row">
							<div class="col-xl-3 col-md-12">
								{% if submitted == true and project.softDeadline|date("ymd") >= "now"|date("ymd") %}

									<a href="{{path("student_submit", {"project_id":project.id})}}" class="btn btn-success btn-sm mr-2">
										<i class="fas fa-file-upload"></i>
										Remettre à nouveau
									</a>
								{% elseif project.softDeadline|date("ymd") >= "now"|date("ymd") %}
									<a href="{{path("student_submit", {"project_id":project.id})}}" class="btn btn-warning btn-sm mr-2">
										<i class="fas fa-file-upload"></i>
										Remettre
									</a>
								{% elseif submitted == false %}
									<a href="{{path("student_submit", {"project_id":project.id})}}" class="btn btn-danger btn-sm">
										<i class="fas fa-file-upload"></i>
										Remettre en retard
									</a>
								{% endif %}

							</div>
						</div>
					</div>

				{% endif %}

				{% set evalue = 0 %}
				{% for assessment in project.assessments %}
					{% for result in assessment.results %}
						{% if result.student == student %}
							{% set evalue = 1 %}

						{% endif %}
					{% endfor %}
				{% endfor %}

				<div class="card-body dashed-top-border pb-0">
					{% if submitted == false and project.external == false %}

						<span class="badge badge-danger">Non remis</span>
						<span class="text-primary ml-3">
							<i class="fas fa-calendar-times"></i>
							À remettre pour le
							<b>{{project.softDeadline|format_date('full', '', 'Europe/Brussels' )}}</b>.
						</span>

					{% elseif submitted == true and project.external == false %}
						<span class="badge badge-success">Remis</span>
					{% elseif  project.external == true %}
						<span class="badge  badge-success">Évaluation écrite</span>
					{% endif %}

					{% if evalue == 1 %}
						<span class="badge badge-info">Évalué</span>
					{% endif %}

				</div>
			</div>


		</div>
		{% endif %}
	{% endfor %}
{% endblock %}
{% block scripts %}
	<script src="{{asset('js/lightgallery-all.min.js') }}"></script>
{% endblock %}

{% block stylesheets %}
	<link type="text/css" rel="stylesheet" href="{{asset('css/lightgallery.min.css') }}"/>
{% endblock %}

{% block page_scripts %}
	<script type="text/javascript">
		$(document).ready(function () {
$(".lightgallery").lightGallery();
});
	</script>

{% endblock %}
